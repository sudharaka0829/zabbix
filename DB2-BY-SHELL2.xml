SELECT h.host AS hostname, i.lastvalue AS agent_version
FROM hosts h
JOIN items i ON h.hostid = i.hostid
WHERE i.key_ = 'agent.version';


SELECT h.host AS hostname, i.lastvalue AS agent_version
FROM hosts h
JOIN items i ON h.hostid = i.hostid
WHERE i.key_ = 'agent.version';


SELECT h.host AS hostname, h.lastip, h.hostid, 
       (SELECT lastvalue FROM history 
        WHERE itemid = i.itemid 
        ORDER BY clock DESC 
        LIMIT 1) AS agent_version
FROM hosts h
JOIN items i ON h.hostid = i.hostid
WHERE i.key_ = 'agent.version';

SELECT 
    h.host AS hostname, 
    h.hostid,
    (SELECT value 
     FROM history 
     WHERE itemid = i.itemid 
     ORDER BY clock DESC 
     LIMIT 1) AS agent_version
FROM hosts h
JOIN items i ON h.hostid = i.hostid
WHERE i.key_ = 'agent.version';




SELECT h.host AS 'Hostname', it.ip AS 'IP Address', MAX(x.value) AS 'Agent Version' FROM items i LEFT JOIN hosts h ON i.hostid = h.hostid LEFT JOIN history_str x ON x.itemid = i.itemid LEFT JOIN interface it ON h.hostid = it.hostid WHERE i.key_ = 'agent.version' AND x.value IS NOT NULL; GROUP BY h.host, it.ip;


SELECT 
    h.host AS 'Hostname', 
    it.ip AS 'IP Address', 
    MAX(x.value) AS 'Agent Version' 
FROM 
    items i 
LEFT JOIN 
    hosts h ON i.hostid = h.hostid 
LEFT JOIN 
    history_str x ON x.itemid = i.itemid 
LEFT JOIN 
    interface it ON h.hostid = it.hostid 
WHERE 
    i.key_ = 'agent.version' 
    AND x.value IS NOT NULL 
GROUP BY 
    h.host, it.ip;

SELECT h.host AS 'Hostname', it.ip AS 'IP Address', MAX(x.value) AS 'Agent Version', h.type AS 'Agent Type' FROM items i LEFT JOIN hosts h ON i.hostid = h.hostid LEFT JOIN history_str x ON x.itemid = i.itemid LEFT JOIN interface it ON h.hostid = it.hostid WHERE i.key_ = 'agent.version' AND x.value IS NOT NULL GROUP BY h.host, it.ip, h.type;


SELECT h.host AS hostname, i.ip AS ip_address, g.name AS host_group, 'Agent' AS agent_type, CASE WHEN h.status = 0 THEN 'Enabled' ELSE 'Disabled' END AS host_status, CASE WHEN hu.value = 1 THEN 'OK' ELSE 'Not OK' END AS ping_status FROM hosts h JOIN interface i ON h.hostid = i.hostid JOIN hosts_groups hg ON h.hostid = hg.hostid JOIN hstgrp g ON hg.groupid = g.groupid LEFT JOIN items it ON h.hostid = it.hostid AND it.key_ = 'icmpping' LEFT JOIN history_uint hu ON it.itemid = hu.itemid AND hu.clock = (SELECT MAX(clock) FROM history_uint WHERE itemid = it.itemid) WHERE i.type = 1 ORDER BY h.hostid, i.interfaceid;


SELECT h.host AS hostname, i.ip AS ip_address, g.name AS host_group, CASE WHEN h.type = 2 THEN 'SNMP' WHEN h.type = 1 THEN 'Agent' ELSE 'Other' END AS agent_type, CASE WHEN h.status = 0 THEN 'Enabled' ELSE 'Disabled' END AS host_status, CASE WHEN hu.value = 1 THEN 'OK' ELSE 'Not OK' END AS ping_status, MAX(it_agent.value) AS agent_version FROM hosts h JOIN interface i ON h.hostid = i.hostid JOIN hosts_groups hg ON h.hostid = hg.hostid JOIN hstgrp g ON hg.groupid = g.groupid LEFT JOIN items it ON h.hostid = it.hostid AND it.key_ = 'icmpping' LEFT JOIN history_uint hu ON it.itemid = hu.itemid AND hu.clock = (SELECT MAX(clock) FROM history_uint WHERE itemid = it.itemid) LEFT JOIN items it_agent ON h.hostid = it_agent.hostid AND it_agent.key_ = 'agent.version' LEFT JOIN history_str x ON it_agent.itemid = x.itemid WHERE i.type = 1 GROUP BY h.hostid, i.interfaceid, g.name, h.type, h.status, hu.value ORDER BY h.hostid, i.interfaceid;