SELECT h.host AS hostname, i.lastvalue AS agent_version
FROM hosts h
JOIN items i ON h.hostid = i.hostid
WHERE i.key_ = 'agent.version';


SELECT h.host AS hostname, i.lastvalue AS agent_version
FROM hosts h
JOIN items i ON h.hostid = i.hostid
WHERE i.key_ = 'agent.version';


SELECT h.host AS hostname, h.lastip, h.hostid, 
       (SELECT lastvalue FROM history 
        WHERE itemid = i.itemid 
        ORDER BY clock DESC 
        LIMIT 1) AS agent_version
FROM hosts h
JOIN items i ON h.hostid = i.hostid
WHERE i.key_ = 'agent.version';

SELECT 
    h.host AS hostname, 
    h.hostid,
    (SELECT value 
     FROM history 
     WHERE itemid = i.itemid 
     ORDER BY clock DESC 
     LIMIT 1) AS agent_version
FROM hosts h
JOIN items i ON h.hostid = i.hostid
WHERE i.key_ = 'agent.version';




SELECT h.host AS 'Hostname', it.ip AS 'IP Address', MAX(x.value) AS 'Agent Version' FROM items i LEFT JOIN hosts h ON i.hostid = h.hostid LEFT JOIN history_str x ON x.itemid = i.itemid LEFT JOIN interface it ON h.hostid = it.hostid WHERE i.key_ = 'agent.version' AND x.value IS NOT NULL; GROUP BY h.host, it.ip;


SELECT 
    h.host AS 'Hostname', 
    it.ip AS 'IP Address', 
    MAX(x.value) AS 'Agent Version' 
FROM 
    items i 
LEFT JOIN 
    hosts h ON i.hostid = h.hostid 
LEFT JOIN 
    history_str x ON x.itemid = i.itemid 
LEFT JOIN 
    interface it ON h.hostid = it.hostid 
WHERE 
    i.key_ = 'agent.version' 
    AND x.value IS NOT NULL 
GROUP BY 
    h.host, it.ip;

SELECT h.host AS 'Hostname', it.ip AS 'IP Address', MAX(x.value) AS 'Agent Version', h.type AS 'Agent Type' FROM items i LEFT JOIN hosts h ON i.hostid = h.hostid LEFT JOIN history_str x ON x.itemid = i.itemid LEFT JOIN interface it ON h.hostid = it.hostid WHERE i.key_ = 'agent.version' AND x.value IS NOT NULL GROUP BY h.host, it.ip, h.type;
